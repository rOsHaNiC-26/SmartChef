{% extends 'base.html' %}
{% load static %}

{% block content %}
<section class="profile-page">
    <div class="profile-container">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="profile-cover">
                <div class="cover-pattern"></div>
            </div>
            <div class="profile-info">
                <div class="profile-avatar">
                    <span class="avatar-text">{{ user.username|slice:":1"|upper }}</span>
                </div>
                <div class="profile-details">
                    <h1 class="profile-name">{{ user.username }}</h1>
                    <p class="profile-email"><i class="fas fa-envelope"></i> {{ user.email }}</p>
                </div>
                <div class="profile-stats">
                    <div class="stat">
                        <span class="stat-number">{{ total_recipes }}</span>
                        <span class="stat-label" data-en="Recipes" data-hi="à¤°à¥‡à¤¸à¤¿à¤ªà¥€" data-mr="à¤°à¥‡à¤¸à¤¿à¤ªà¥€">Recipes</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">{{ total_views }}</span>
                        <span class="stat-label" data-en="Views" data-hi="à¤µà¥à¤¯à¥‚à¤œ" data-mr="à¤µà¥à¤¹à¥à¤¯à¥‚à¤œ">Views</span>
                    </div>
                    <div class="stat">
                        <span class="stat-number">{{ total_likes }}</span>
                        <span class="stat-label" data-en="Likes" data-hi="à¤²à¤¾à¤‡à¤•à¥à¤¸" data-mr="à¤²à¤¾à¤‡à¤•à¥à¤¸">Likes</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div class="settings-section">
            <h2>
                <i class="fas fa-cog"></i>
                <span data-en="Settings" data-hi="à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—à¥à¤¸" data-mr="à¤¸à¥‡à¤Ÿà¤¿à¤‚à¤—à¥à¤¸">Settings</span>
            </h2>

            <div class="settings-grid">
                <!-- Language Setting -->
                <div class="setting-card">
                    <div class="setting-header">
                        <i class="fas fa-language"></i>
                        <div>
                            <h3 data-en="Language" data-hi="à¤­à¤¾à¤·à¤¾" data-mr="à¤­à¤¾à¤·à¤¾">Language</h3>
                            <p data-en="Choose your preferred language" data-hi="à¤…à¤ªà¤¨à¥€ à¤ªà¤¸à¤‚à¤¦à¥€à¤¦à¤¾ à¤­à¤¾à¤·à¤¾ à¤šà¥à¤¨à¥‡à¤‚"
                                data-mr="à¤¤à¥à¤®à¤šà¥€ à¤†à¤µà¤¡à¤¤à¥€ à¤­à¤¾à¤·à¤¾ à¤¨à¤¿à¤µà¤¡à¤¾">Choose your preferred language</p>
                        </div>
                    </div>
                    <div class="setting-options language-options">
                        <button class="lang-option {% if user.language == 'en' %}active{% endif %}"
                            onclick="updateSetting('language', 'en')" data-lang="en">
                            <span class="lang-flag">ðŸ‡¬ðŸ‡§</span>
                            <span>English</span>
                        </button>
                        <button class="lang-option {% if user.language == 'hi' %}active{% endif %}"
                            onclick="updateSetting('language', 'hi')" data-lang="hi">
                            <span class="lang-flag">ðŸ‡®ðŸ‡³</span>
                            <span>à¤¹à¤¿à¤‚à¤¦à¥€</span>
                        </button>
                        <button class="lang-option {% if user.language == 'mr' %}active{% endif %}"
                            onclick="updateSetting('language', 'mr')" data-lang="mr">
                            <span class="lang-flag">ðŸ‡®ðŸ‡³</span>
                            <span>à¤®à¤°à¤¾à¤ à¥€</span>
                        </button>
                    </div>
                </div>

                <!-- Theme Setting -->
                <div class="setting-card">
                    <div class="setting-header">
                        <i class="fas fa-palette"></i>
                        <div>
                            <h3 data-en="Theme" data-hi="à¤¥à¥€à¤®" data-mr="à¤¥à¥€à¤®">Theme</h3>
                            <p data-en="Choose light or dark mode" data-hi="à¤²à¤¾à¤‡à¤Ÿ à¤¯à¤¾ à¤¡à¤¾à¤°à¥à¤• à¤®à¥‹à¤¡ à¤šà¥à¤¨à¥‡à¤‚"
                                data-mr="à¤²à¤¾à¤‡à¤Ÿ à¤•à¤¿à¤‚à¤µà¤¾ à¤¡à¤¾à¤°à¥à¤• à¤®à¥‹à¤¡ à¤¨à¤¿à¤µà¤¡à¤¾">Choose light or dark mode</p>
                        </div>
                    </div>
                    <div class="setting-options theme-options">
                        <button class="theme-option {% if user.theme == 'light' %}active{% endif %}"
                            onclick="updateSetting('theme', 'light')" data-theme="light">
                            <i class="fas fa-sun"></i>
                            <span data-en="Light" data-hi="à¤²à¤¾à¤‡à¤Ÿ" data-mr="à¤²à¤¾à¤‡à¤Ÿ">Light</span>
                        </button>
                        <button class="theme-option {% if user.theme == 'dark' %}active{% endif %}"
                            onclick="updateSetting('theme', 'dark')" data-theme="dark">
                            <i class="fas fa-moon"></i>
                            <span data-en="Dark" data-hi="à¤¡à¤¾à¤°à¥à¤•" data-mr="à¤¡à¤¾à¤°à¥à¤•">Dark</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Actions -->
        <div class="profile-actions">
            <a href="{% url 'my_recipes' %}" class="btn btn-primary btn-lg">
                <i class="fas fa-book"></i>
                <span data-en="My Recipes" data-hi="à¤®à¥‡à¤°à¥€ à¤°à¥‡à¤¸à¤¿à¤ªà¥€" data-mr="à¤®à¤¾à¤à¥€ à¤°à¥‡à¤¸à¤¿à¤ªà¥€">My Recipes</span>
            </a>
            <a href="{% url 'add_recipe' %}" class="btn btn-outline btn-lg">
                <i class="fas fa-plus"></i>
                <span data-en="Add Recipe" data-hi="à¤°à¥‡à¤¸à¤¿à¤ªà¥€ à¤œà¥‹à¤¡à¤¼à¥‡à¤‚" data-mr="à¤°à¥‡à¤¸à¤¿à¤ªà¥€ à¤œà¥‹à¤¡à¤¾">Add Recipe</span>
            </a>
            <a href="{% url 'logout' %}" class="btn btn-danger btn-lg">
                <i class="fas fa-sign-out-alt"></i>
                <span data-en="Logout" data-hi="à¤²à¥‰à¤—à¤†à¤‰à¤Ÿ" data-mr="à¤²à¥‰à¤—à¤†à¤‰à¤Ÿ">Logout</span>
            </a>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
    function updateSetting(type, value) {
        // Redirect to specific handlers
        if (type === 'language') {
            document.querySelectorAll('.lang-option').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-lang="${value}"]`).classList.add('active');
            changeLanguage(value); // calls main.js function
        } else if (type === 'theme') {
            document.querySelectorAll('.theme-option').forEach(btn => btn.classList.remove('active'));
            document.querySelector(`[data-theme="${value}"]`).classList.add('active');

            // Apply theme immediately
            document.documentElement.setAttribute('data-theme', value);
            const themeIcon = document.getElementById('themeIcon');
            if (themeIcon) {
                themeIcon.className = value === 'dark' ? 'fas fa-moon' : 'fas fa-sun';
            }

            updateThemeOnServer(value); // calls main.js function
        }
    }
</script>
{% endblock %}